
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Weichien's studying note</title>
	<meta name="author" content="Weichien Hung">

	
	<meta name="description" content="As a web developer, nginx is often used in deployment architecture.
Write down the useful nginx configuration examples here. Intall nginx is very &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Weichien's studying note" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><a class="myheader-avatar" href="/"><img src="/images/samuel.jpg"></a>
<div class="myheader-slogan">
<h1><a href="/">Weichien's studying note</a></h1>
<h2>Practice makes perfect</h2>
</div>
<nav id="main-nav"><ul class="main">
	<!-- <li><a href="/">Blog</a></li> -->
	<li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/categories">Tags</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a id="menu-btn" class="button">Menu</a>
		<div class="container"><ul class="main">
	<!-- <li><a href="/">Blog</a></li> -->
	<li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/categories">Tags</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:weichienhung.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		<a class="facebook" href="http://www.facebook.com/weichien.hung" title="Facebook">Facebook</a>
		
		
		<a class="google" href="https://plus.google.com/113676445086645352045?rel=author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/HungWeichien" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/weichienhung" title="GitHub">GitHub</a>
		
    
		
		
		
		
		<!-- 
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		 -->
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:weichienhung.github.io">
	</form>
</nav>

</header>
<!-- 	
		
	 -->
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/01/25/nginx-configuration/">
		
			Nginx Configuration</a>
	</h2>
	<div class="entry-content">
		<p>As a web developer, nginx is often used in deployment architecture.
Write down the useful nginx configuration examples here.</p>

<p>Intall nginx is very easy and not describe here. Configuration good reference <a href="https://calomel.org/nginx.html">here</a></p>

<p>底下的設定值是用最基本的nginx install, 沒有額外的module</p>

<h3>Basic configuration</h3>

<figure class='code'><figcaption><span>/etc/nginx/nginx.conf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># 最基本的設定,不詳述</span>
</span><span class='line'>user  nginx;
</span><span class='line'>worker_processes  1;
</span><span class='line'>pid        /var/run/nginx.pid;
</span><span class='line'>
</span><span class='line'>events <span class="o">{</span>
</span><span class='line'>  worker_connections  1024;
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>http <span class="o">{</span>
</span><span class='line'>  <span class="c"># 載入支援的mime type</span>
</span><span class='line'>  include       /etc/nginx/mime.types;
</span><span class='line'>
</span><span class='line'>  <span class="c"># 當有不認識的mime type時就用octet-stream當一般binary檔案處理</span>
</span><span class='line'>  default_type  application/octet-stream;
</span><span class='line'>
</span><span class='line'>  <span class="c"># 定義自己的log format</span>
</span><span class='line'>  log_format  main  <span class="s1">&#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span>
</span><span class='line'>                    <span class="s1">&#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span>
</span><span class='line'>                    <span class="s1">&#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;</span>;
</span><span class='line'>
</span><span class='line'>  <span class="c"># access log存放位置並且使用 main 這個log format,也就是上述定義的格式</span>
</span><span class='line'>  <span class="c"># buffer=8k 表示不會一直寫log到disk,等到buffer滿了才寫,避免I/O過重</span>
</span><span class='line'>  access_log  /var/log/nginx/access.log main <span class="nv">buffer</span><span class="o">=</span>8k;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="c">## Size Limits</span>
</span><span class='line'>  <span class="c"># 當request body超過這個body size時會被先寫進暫存檔處理</span>
</span><span class='line'>  client_body_buffer_size   8k;
</span><span class='line'>
</span><span class='line'>  <span class="c"># 限制http header的大小</span>
</span><span class='line'>  client_header_buffer_size 1k;
</span><span class='line'>
</span><span class='line'>  <span class="c"># 限制request body大小，超過server會回傳413(Request Entity Too Large)</span>
</span><span class='line'>  client_max_body_size      1m;
</span><span class='line'>
</span><span class='line'>  <span class="c">## Timeouts, do not keep connections open longer then necessary to reduce</span>
</span><span class='line'>  <span class="c"># 讀取request body timeout時間,超過時間會回傳408(Request time out)</span>
</span><span class='line'>  client_body_timeout     4s;
</span><span class='line'>
</span><span class='line'>  <span class="c"># 讀取request header timeout時間(e.g GET HTTP/1.1),超過時間回傳408(Request time out)</span>
</span><span class='line'>  client_header_timeout   2s;
</span><span class='line'>
</span><span class='line'>  <span class="c"># HTTP 1.1 keepalive的timeout時間, 各家browser各有不同時間.</span>
</span><span class='line'>  keepalive_timeout       65s;
</span><span class='line'>
</span><span class='line'>  <span class="c"># 送資料給client的timeout時間(指得是兩次資料讀取時間), 降低這個值可以避免Slowloris DoS attack</span>
</span><span class='line'>  send_timeout            5s;
</span><span class='line'>
</span><span class='line'>  <span class="c">## General Options</span>
</span><span class='line'>  <span class="c"># 設定值 &gt;=1 的話讓NGINX支持下載部份檔。 如果你的server有要讓人下載大檔續傳的話..</span>
</span><span class='line'>  max_ranges 0;
</span><span class='line'>
</span><span class='line'>  <span class="c"># keepalive的連線最大數量</span>
</span><span class='line'>  keepalive_requests        5;
</span><span class='line'>
</span><span class='line'>  <span class="c"># Browder cache 失效時間, 負值的話表示不要有任何cache.</span>
</span><span class='line'>  expires 1d;
</span><span class='line'>
</span><span class='line'>  <span class="c"># Request limits</span>
</span><span class='line'>  <span class="c"># 限制一個IP在1秒內只處理5個requests</span>
</span><span class='line'>  <span class="c"># myzone是自行定義的名稱,用來存放IP, 2m表示最大不超過2M記憶體</span>
</span><span class='line'>  limit_req_zone  <span class="nv">$binary_remote_addr</span>  <span class="nv">zone</span><span class="o">=</span>myzone:2m  <span class="nv">rate</span><span class="o">=</span>5r/s;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 載入其它設定檔</span>
</span><span class='line'>  include /etc/nginx/conf.d/*.conf;
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>How to reverse proxy?</h3>


		
		<a href="/blog/2014/01/25/nginx-configuration/" class="more-link">Continue reading &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-01-25T10:04:00+08:00" pubdate data-updated="true">Jan 25<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/linux/'>linux</a>


</div>
	
	<div class="comments"><a href="/blog/2014/01/25/nginx-configuration/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/01/11/emberjs-data-trying/">
		
			Emberjs-data Trying</a>
	</h2>
	<div class="entry-content">
		<p>In my old emberjs project(<a href="https://github.com/weichienhung/money">money</a>,<a href="https://github.com/weichienhung/food-ntpc">food-ntpc</a>)
i didn&#8217;t use <a href="https://github.com/emberjs/data">ember-data</a> to handle data processing with backend server.
The ember-data is closed to 1.0.0(now is 1.0.0.beta4) so i give it a try.
The official document is quite less and some posts in StackOverflow are out of date.
Checkout their source code is the quickest way to understand how they work and do customized.
I write down tips here for my reference in the future.</p>

<p>Define your store to use ember-data</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">MyAdapter = </span><span class="nx">DS</span><span class="p">.</span><span class="nx">RESTAdapter</span><span class="p">.</span><span class="nx">extend</span>
</span><span class='line'>
</span><span class='line'><span class="nv">MyApp.Store = </span><span class="nx">DS</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">extend</span>
</span><span class='line'>  <span class="nv">revision: </span><span class="mi">11</span>
</span><span class='line'>  <span class="nv">adapter: </span><span class="nx">MyAdapter</span>
</span></code></pre></td></tr></table></div></figure>


<p>Assume your have a <code>record</code> object and json format is</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nt">&quot;record&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="mi">150</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;category_id&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;dinner&quot;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Define your model object.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">MyApp.Record = </span><span class="nx">DS</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span>
</span><span class='line'>  <span class="nv">category_id: </span><span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;number&#39;</span>
</span><span class='line'>  <span class="nv">amount: </span><span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;number&#39;</span>
</span><span class='line'>  <span class="nv">description: </span><span class="nx">DS</span><span class="p">.</span><span class="nx">attr</span> <span class="s">&#39;string&#39;</span>
</span></code></pre></td></tr></table></div></figure>





		
		<a href="/blog/2014/01/11/emberjs-data-trying/" class="more-link">Continue reading &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-01-11T11:05:00+08:00" pubdate data-updated="true">Jan 11<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/emberjs/'>emberjs</a>


</div>
	
	<div class="comments"><a href="/blog/2014/01/11/emberjs-data-trying/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/28/ui-automation/">
		
			UI Automation</a>
	</h2>
	<div class="entry-content">
		<p>This article is the last one in 2013. In the rails project we use capybara to do UI testing.
Like click a button/link or fill the form. But i will show how to use capybara without rails in UI automation today.</p>

<p>Sometimes we have to repeat trivial works and these require user to interactive with browser.
For instance, upload file to server or input necessary data.</p>

<p>Install below gems and Firefox</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>gem install capybara
</span><span class='line'>gem install selenium-webdriver
</span></code></pre></td></tr></table></div></figure>


<p>In orer to use capybara without rails. You need to require <code>capybara</code> manually.
In default capybara will launch rack server, change <code>run_server</code> to <code>false</code>.
Because we assume your server is running. Use <code>selenium</code> as <code>driver</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;capybara&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;capybara/dsl&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">run_server</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">current_driver</span> <span class="o">=</span> <span class="ss">:selenium</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># it will open the browser to 127.0.0.1:8888/admin</span>
</span><span class='line'><span class="no">Capybara</span><span class="o">.</span><span class="n">app_host</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:8888/admin&#39;</span>
</span></code></pre></td></tr></table></div></figure>



		
		<a href="/blog/2013/12/28/ui-automation/" class="more-link">Continue reading &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-28T15:47:00+08:00" pubdate data-updated="true">Dec 28<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
	<div class="comments"><a href="/blog/2013/12/28/ui-automation/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/14/utility-tool-by-ruby/">
		
			Useful Methods in Ruby</a>
	</h2>
	<div class="entry-content">
		<p>This week i write automatic utility tools for colleague.
It saves time and reduce trivial works. Learn useful ruby built-in methods.</p>

<h3>List all under a folder</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># lists all files and folders under target/ folder</span>
</span><span class='line'><span class="no">Dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;target/**/**&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
</span><span class='line'>  <span class="k">if</span> <span class="no">File</span><span class="o">.</span><span class="n">directory?</span> <span class="n">f</span>
</span><span class='line'>    <span class="c1"># do something</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="c1"># do something</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># ONLY list all in target/ , doesn&#39;t list subfolders like target/subfolders/</span>
</span><span class='line'><span class="no">Dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;target/**&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>



		
		<a href="/blog/2013/12/14/utility-tool-by-ruby/" class="more-link">Continue reading &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-14T21:14:00+08:00" pubdate data-updated="true">Dec 14<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/ruby/'>ruby</a>


</div>
	
	<div class="comments"><a href="/blog/2013/12/14/utility-tool-by-ruby/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/11/30/new-practicing-rails-project/">
		
			New Rails Project for Fun</a>
	</h2>
	<div class="entry-content">
		<p>Today i push a new rails project to <a href="http://weichien-lunch.herokuapp.com/">heroku</a> called lunch.
I also push to <a href="https://github.com/weichienhung/lunch">github</a>.
Every week day i and colleague have to discuss which lunch to eat.
It will be very helpful if a site can random pick a lunch restaurant for us. So i create a new rails project for this purpose.
The basic idea is simple, everybody can share a restaurant and add others&#8217; restaurants to favorites list. Then site pick a restaurant for you.
I can study new stuff when i practice rails each time. I try to write down here.</p>


		
		<a href="/blog/2013/11/30/new-practicing-rails-project/" class="more-link">Continue reading &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-11-30T20:16:00+08:00" pubdate data-updated="true">Nov 30<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>


</div>
	
	<div class="comments"><a href="/blog/2013/11/30/new-practicing-rails-project/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/11/03/open-source-projects-studying/">
		
			Open Source Project Studying</a>
	</h2>
	<div class="entry-content">
		<p>I study the open source project <a href="https://github.com/gitlabhq/gitlabhq">gitlab</a>. It&#8217;s a well coding rails structure.
Here are some examples i think they are good.</p>

<h3>Don&#8217;t query data in View/Helper</h3>

<p>Avoid perform query in view/helper in Xdite&#8217;s <a href="http://blog.xdite.net/posts/2013/10/31/maintainable-rails-view-6">Maintainable Rails View</a>.</p>

<figure class='code'><figcaption><span>dashboard_controller.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">show</span>
</span><span class='line'>  <span class="vi">@projects_limit</span> <span class="o">=</span> <span class="mi">30</span>
</span><span class='line'>  <span class="vi">@groups</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">authorized_groups</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:human_name</span><span class="p">)</span>
</span><span class='line'>  <span class="vi">@has_authorized_projects</span> <span class="o">=</span> <span class="vi">@projects</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span class='line'>  <span class="vi">@projects_count</span> <span class="o">=</span> <span class="vi">@projects</span><span class="o">.</span><span class="n">count</span>
</span><span class='line'>  <span class="vi">@projects</span> <span class="o">=</span> <span class="vi">@projects</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="vi">@projects_limit</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="vi">@events</span> <span class="o">=</span> <span class="no">Event</span><span class="o">.</span><span class="n">in_projects</span><span class="p">(</span><span class="n">current_user</span><span class="o">.</span><span class="n">authorized_projects</span><span class="o">.</span><span class="n">pluck</span><span class="p">(</span><span class="ss">:id</span><span class="p">))</span>
</span><span class='line'>  <span class="vi">@events</span> <span class="o">=</span> <span class="vi">@event_filter</span><span class="o">.</span><span class="n">apply_filter</span><span class="p">(</span><span class="vi">@events</span><span class="p">)</span>
</span><span class='line'>  <span class="vi">@events</span> <span class="o">=</span> <span class="vi">@events</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:offset</span><span class="o">]</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="vi">@last_push</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">recent_push</span>
</span><span class='line'>  <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>    <span class="nb">format</span><span class="o">.</span><span class="n">html</span>
</span><span class='line'>    <span class="nb">format</span><span class="o">.</span><span class="n">js</span>
</span><span class='line'>    <span class="nb">format</span><span class="o">.</span><span class="n">atom</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">layout</span><span class="p">:</span> <span class="kp">false</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>



		
		<a href="/blog/2013/11/03/open-source-projects-studying/" class="more-link">Continue reading &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-11-03T09:57:00+08:00" pubdate data-updated="true">Nov 3<span>rd</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>


</div>
	
	<div class="comments"><a href="/blog/2013/11/03/open-source-projects-studying/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/10/25/mongodb-in-rails/">
		
			Mongodb in Rails4</a>
	</h2>
	<div class="entry-content">
		<p>In the past week i had tried <a href="http://www.mongodb.org">mongodb</a> in rails.
I rewrite my previous project <a href="https://github.com/weichienhung/money">money</a> to use mongodb instead of active record.
The source code is in branch <a href="https://github.com/weichienhung/money/tree/mongodb">money-mongodb</a>.
Here i record the steps of changing active record to mongodb</p>


		
		<a href="/blog/2013/10/25/mongodb-in-rails/" class="more-link">Continue reading &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-10-25T23:53:00+08:00" pubdate data-updated="true">Oct 25<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>


</div>
	
	<div class="comments"><a href="/blog/2013/10/25/mongodb-in-rails/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/10/19/design-pattern-in-javascript/">
		
			Design Pattern in Javascript</a>
	</h2>
	<div class="entry-content">
		<p>I read the <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/">javascript design pattern</a> from Addy Osmani.
There&#8217;re code examples in the book and i try to re-write it by coffeescript.
It helps me understand pattern more and clear. During writing i found a good coffeescript <a href="http://coffeescriptcookbook.com">cookbook</a> and very helpful.
I put the final result to <a href="https://gist.github.com/weichienhung/7055412">gist</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-10-19T14:50:00+08:00" pubdate data-updated="true">Oct 19<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/coffeescript/'>coffeescript</a>


</div>
	
	<div class="comments"><a href="/blog/2013/10/19/design-pattern-in-javascript/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/10/13/testing/">
		
			Testing,Documentation and Others</a>
	</h2>
	<div class="entry-content">
		<p>Past two weeks, i have studied some useful gems in rails. Here are the summary and tips.</p>

<h2><a href="https://github.com/cucumber/cucumber-rails">Cucumber</a></h2>

<p>Cucumber is the Behavior Driven Development(BDD). Writing testing is the most important in software development.
Without testing case it&#8217;s hard to refactor any code in the future.</p>

<p>For instance: my site provide REST API with JSON and require devise login to use.
How to test?<br/>
Add to Gemfile. Suggest to use rspec and factory_gril gems together.</p>

<figure class='code'><figcaption><span>Gemfile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">group</span> <span class="ss">:test</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;rspec-rails&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;cucumber-rails&#39;</span><span class="p">,</span> <span class="ss">:require</span> <span class="o">=&gt;</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;factory_girl_rails&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;database_cleaner&#39;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="n">group</span> <span class="ss">:development</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;rspec-rails&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run <code>rails g cucumber:install</code> to initial features/ structure.</p>


		
		<a href="/blog/2013/10/13/testing/" class="more-link">Continue reading &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-10-13T19:38:00+08:00" pubdate data-updated="true">Oct 13<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/rails/'>rails</a>


</div>
	
	<div class="comments"><a href="/blog/2013/10/13/testing/#disqus_thread">Comments</a></div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/10/12/animated-on-media-query/">
		
			Animated on Media Query</a>
	</h2>
	<div class="entry-content">
		<p>I see a post <a href="http://css-tricks.com/animated-media-queries/?utm_source=dlvr.it&amp;utm_medium=twitter">animated on media query</a> today.
It&#8217;s very interest to put CSS transition on media query changed. It&#8217;s a simple skill and i just try it on my blog.
You could resize my blog to check it.<br/>
For example: add width transition to my avatar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.myheader-avatar</span> <span class="o">&gt;</span> <span class="nt">img</span><span class="p">{</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">60px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">60px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
</span><span class='line'>  <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">30px</span><span class="p">;</span>
</span><span class='line'>  <span class="o">@</span><span class="n">include</span> <span class="n">high_z_index</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c">/* New line. */</span>
</span><span class='line'>  <span class="n">transition</span><span class="o">:</span> <span class="k">width</span> <span class="m">1.5s</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">700px</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nc">.myheader-avatar</span> <span class="o">&gt;</span> <span class="nt">img</span> <span class="p">{</span>
</span><span class='line'>    <span class="c">/* When devie max-width under 700px, change width to 0 */</span>
</span><span class='line'>    <span class="k">height</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>    <span class="k">width</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c">/* transition can&#39;t put on display. So i change it to set width=0 */</span>
</span><span class='line'>    <span class="c">/* display: none; */</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Originally i use <code>display:none</code> to hide avatar but it doesn&#8217;t work with transition. I use <code>width=0</code> insteadly.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-10-12T14:44:00+08:00" pubdate data-updated="true">Oct 12<span>th</span>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/css/'>css</a>


</div>
	
	<div class="comments"><a href="/blog/2013/10/12/animated-on-media-query/#disqus_thread">Comments</a></div>
	
</div>
</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Old</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2014

    Weichien Hung

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $(document).ready(function(){
    $('.fancybox').fancybox();
  })
})(jQuery);
</script> 


<script type="text/javascript">
      var disqus_shortname = 'weichienhung';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>